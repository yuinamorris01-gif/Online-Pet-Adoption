{% extends "base.html" %}
{% block title %}Application Details - ADOPT ME Admin{% endblock %}

{% block content %}
<div class="admin-application-detail-page">
    <!-- Header Section -->
    <div class="admin-page-header" data-aos="fade-down">
        <div class="container">
            <div class="page-header-content">
                <div class="header-left">
                    <div class="page-breadcrumb">
                        <a href="{{ url_for('admin_dashboard') }}" class="breadcrumb-link">
                            <i class="fas fa-tachometer-alt"></i>
                            Dashboard
                        </a>
                        <span class="breadcrumb-separator">/</span>
                        <a href="{{ url_for('admin_applications') }}" class="breadcrumb-link">
                            <i class="fas fa-clipboard-list"></i>
                            Applications
                        </a>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-current">Application Details</span>
                    </div>
                    <h1 class="page-title">
                        <i class="fas fa-file-alt"></i>
                        Application Review
                    </h1>
                    <p class="page-subtitle">Review and manage adoption application details</p>
                </div>
                <div class="header-right">
                    <a href="{{ url_for('admin_applications') }}" class="modern-btn secondary">
                        <i class="fas fa-arrow-left"></i>
                        <span>Back to Applications</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Content -->
    {% if application %}
    <div class="application-detail-content">
        <div class="container">
            <!-- Status Banner -->
            <div class="status-banner" data-aos="fade-up" data-aos-delay="100">
                <div class="status-content">
                    <div class="status-info">
                        {% if application.status == 'pending' %}
                        <div class="status-badge pending large">
                            <i class="fas fa-clock"></i>
                            <span>Pending Review</span>
                        </div>
                        <p class="status-text">This application requires your review and decision.</p>
                        {% elif application.status == 'approved' %}
                        <div class="status-badge approved large">
                            <i class="fas fa-check-circle"></i>
                            <span>Approved</span>
                        </div>
                        <p class="status-text">This application has been approved for adoption.</p>
                        {% elif application.status == 'denied' %}
                        <div class="status-badge denied large">
                            <i class="fas fa-times-circle"></i>
                            <span>Denied</span>
                        </div>
                        <p class="status-text">This application has been denied.</p>
                        {% endif %}
                    </div>
                    <div class="application-dates">
                        <div class="date-item">
                            <i class="fas fa-calendar-plus"></i>
                            <div>
                                <span class="date-label">Submitted</span>
                                <span class="date-value">{{ application.submitted_at | strftime('%b %d, %Y at %I:%M %p')
                                    }}</span>
                            </div>
                        </div>
                        {% if application.reviewed_at %}
                        <div class="date-item">
                            <i class="fas fa-calendar-check"></i>
                            <div>
                                <span class="date-label">Reviewed</span>
                                <span class="date-value">{{ application.reviewed_at | strftime('%b %d, %Y at %I:%M %p')
                                    }}</span>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="detail-grid">
                <!-- Pet Information Card -->
                <div class="detail-card pet-info-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="card-header">
                        <h3><i class="fas fa-paw"></i> Pet Information</h3>
                    </div>
                    <div class="card-content">
                        <div class="pet-display">
                            <div class="pet-image-section">
                                {% if application.photo_filename %}
                                <img src="{{ url_for('static', filename='images/' + application.photo_filename) }}"
                                    class="pet-detail-image" alt="{{ application.pet_name }}">
                                {% else %}
                                <div class="pet-image-placeholder">
                                    <i class="fas fa-paw"></i>
                                </div>
                                {% endif %}
                            </div>
                            <div class="pet-details">
                                <h4 class="pet-name">{{ application.pet_name }}</h4>
                                <div class="pet-specs">
                                    <span class="spec-item">
                                        <i class="fas fa-tag"></i>
                                        {{ application.species | title }}
                                    </span>
                                    <span class="spec-divider">â€¢</span>
                                    <span class="spec-item">
                                        <i class="fas fa-dna"></i>
                                        {{ application.breed }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Applicant Information Card -->
                <div class="detail-card applicant-info-card" data-aos="fade-up" data-aos-delay="300">
                    <div class="card-header">
                        <h3><i class="fas fa-user"></i> Applicant Information</h3>
                    </div>
                    <div class="card-content">
                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-user-circle"></i>
                                </div>
                                <div class="info-content">
                                    <span class="info-label">Full Name</span>
                                    <span class="info-value">{{ application.applicant_name }}</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div class="info-content">
                                    <span class="info-label">Email Address</span>
                                    <span class="info-value">
                                        <a href="mailto:{{ application.applicant_email }}">{{
                                            application.applicant_email }}</a>
                                    </span>
                                </div>
                            </div>
                            {% if application.applicant_phone %}
                            <div class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="info-content">
                                    <span class="info-label">Phone Number</span>
                                    <span class="info-value">
                                        <a href="tel:{{ application.applicant_phone }}">{{ application.applicant_phone
                                            }}</a>
                                    </span>
                                </div>
                            </div>
                            {% endif %}
                            {% if application.applicant_address %}
                            <div class="info-item">
                                <div class="info-icon">
                                    <i class="fas fa-home"></i>
                                </div>
                                <div class="info-content">
                                    <span class="info-label">Address</span>
                                    <span class="info-value">{{ application.applicant_address }}</span>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Application Details Card -->
                <div class="detail-card application-details-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="card-header">
                        <h3><i class="fas fa-clipboard-check"></i> Application Details</h3>
                    </div>
                    <div class="card-content">
                        <div class="details-grid">
                            <div class="detail-section">
                                <h4><i class="fas fa-building"></i> Housing Information</h4>
                                <div class="detail-item">
                                    <span class="detail-label">Housing Type</span>
                                    <span class="detail-value">{{ application.housing_type | title }}</span>
                                </div>
                            </div>

                            <div class="detail-section">
                                <h4><i class="fas fa-heart"></i> Pet Experience</h4>
                                <div class="detail-item">
                                    <span class="detail-label">Has Other Pets</span>
                                    <span class="detail-value">{{ "Yes" if application.has_other_pets else "No"
                                        }}</span>
                                </div>
                                {% if application.has_other_pets and application.other_pets_description %}
                                <div class="detail-item">
                                    <span class="detail-label">Other Pets Description</span>
                                    <span class="detail-value">{{ application.other_pets_description }}</span>
                                </div>
                                {% endif %}
                                <div class="detail-item">
                                    <span class="detail-label">Experience with Pets</span>
                                    <span class="detail-value">{{ application.experience_with_pets }}</span>
                                </div>
                            </div>

                            <div class="detail-section full-width">
                                <h4><i class="fas fa-comment-alt"></i> Motivation & Additional Information</h4>
                                <div class="detail-item">
                                    <span class="detail-label">Reason for Adoption</span>
                                    <span class="detail-value">{{ application.reason_for_adoption }}</span>
                                </div>
                                {% if application.application_text %}
                                <div class="detail-item">
                                    <span class="detail-label">Additional Information</span>
                                    <span class="detail-value">{{ application.application_text }}</span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Review Panel -->
                <div class="detail-card review-panel" data-aos="fade-up" data-aos-delay="500">
                    <div class="card-header">
                        <h3><i class="fas fa-gavel"></i> Application Review</h3>
                    </div>
                    <div class="card-content">
                        {% if application.status == 'pending' %}
                        <div class="review-form">
                            <form method="POST"
                                action="{{ url_for('admin_review_application', app_id=application.id) }}"
                                id="reviewForm">
                                <div class="form-group">
                                    <label for="admin_notes" class="modern-label">
                                        <i class="fas fa-sticky-note"></i>
                                        Admin Notes (Optional)
                                    </label>
                                    <textarea class="modern-input" id="admin_notes" name="admin_notes" rows="4"
                                        placeholder="Add any notes about this application review..."></textarea>
                                </div>
                                <div class="review-actions">
                                    <button type="submit" name="action" value="approve" class="review-btn approve">
                                        <i class="fas fa-check-circle"></i>
                                        <span>Approve Application</span>
                                    </button>
                                    <button type="submit" name="action" value="deny" class="review-btn deny">
                                        <i class="fas fa-times-circle"></i>
                                        <span>Deny Application</span>
                                    </button>
                                </div>
                            </form>
                        </div>
                        {% else %}
                        <div class="review-completed">
                            <div class="completed-icon">
                                {% if application.status == 'approved' %}
                                <i class="fas fa-check-circle"></i>
                                {% else %}
                                <i class="fas fa-times-circle"></i>
                                {% endif %}
                            </div>
                            <h4>Review Completed</h4>
                            <p>This application has been {{ application.status }}.</p>
                            {% if application.admin_notes %}
                            <div class="final-notes">
                                <h5>Admin Notes:</h5>
                                <p>{{ application.admin_notes }}</p>
                            </div>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <!-- Not Found State -->
    <div class="not-found-section">
        <div class="container">
            <div class="empty-state" data-aos="fade-up">
                <div class="empty-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>Application Not Found</h3>
                <p>The application you are looking for does not exist or has been removed from the system.</p>
                <a href="{{ url_for('admin_applications') }}" class="modern-btn primary">
                    <i class="fas fa-arrow-left"></i>
                    Back to Applications
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}